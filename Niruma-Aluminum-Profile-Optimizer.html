<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Niruma Aluminum Profile Optimizer</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/modal.css">

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Existing jsPDF scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

    <!-- Add this new library for SVG support -->
    <script src="https://cdn.jsdelivr.net/npm/svg2pdf.js@2.2.1/dist/svg2pdf.min.js"></script>

</head>

<body>
    <!-- Sticky Navigation Bar -->
    <nav class="sticky-navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <h2>üóèÔ∏è Niruma Optimizer</h2>
            </div>
            <div class="navbar-menu">
                <a href="#section-hero" class="nav-link" onclick="scrollToSection('section-hero'); return false;">üè†
                    Home</a>
                <a href="#section-add-windows" class="nav-link"
                    onclick="scrollToSection('section-add-windows'); return false;">‚ûï Add Windows</a>
                <a href="#section-window-list" class="nav-link"
                    onclick="scrollToSection('section-window-list'); return false;">ü™ü Windows</a>
                <a href="#section-formulas" class="nav-link"
                    onclick="scrollToSection('section-formulas'); return false;">üß™ Formulas</a>
                <a href="#section-stock" class="nav-link" onclick="scrollToSection('section-stock'); return false;">üì¶
                    Stock</a>
                <a href="#section-supplier" class="nav-link"
                    onclick="scrollToSection('section-supplier'); return false;">üèõÔ∏è Supplier</a>
                <a href="#section-hardware" class="nav-link"
                    onclick="scrollToSection('section-hardware'); return false;">üî© Hardware</a>
                <a href="#section-optimize" class="nav-link"
                    onclick="scrollToSection('section-optimize'); return false;">‚ö° Optimize</a>
                <a href="#section-results" class="nav-link"
                    onclick="scrollToSection('section-results'); return false;">üìä Results</a>
            </div>
            <div class="unit-toggle-compact">
                <span><strong>inches</strong></span>
                <label class="unit-switch">
                    <input type="checkbox" id="unitToggleNav" onchange="toggleUnit()">
                    <span class="slider"></span>
                </label>
                <span><strong>mm</strong></span>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Hero Section -->
        <section id="section-hero" class="section-hero">
            <div class="header">
                <h1 style="font-weight: 800; text-transform: uppercase; letter-spacing: 2px;">Niruma Optimizer</h1>
                <p>Advanced Aluminum Window Profile Optimization System</p>
            </div>
            <div class="section-intro">
                <h2>Project Dashboard</h2>
                <p>Manage your window configurations, stock inventory, and optimize your cutting patterns with ease.</p>
            </div>
        </section>

        <!-- Command Center Dashboard -->
        <h2
            style="text-align: center; margin-top: 40px; color: #2c3e50; font-weight: 800; text-transform: uppercase; letter-spacing: 1px;">
            üéÆ Project Command Center</h2>
        <div class="dashboard-grid">
            <div class="tile tile-blue" onclick="scrollToSection('section-add-windows')">
                <div class="tile-icon">‚ûï</div>
                <div class="tile-title">Add Window</div>
                <div class="tile-status">Configure New</div>
            </div>
            <div class="tile tile-green" onclick="scrollToSection('section-window-list')">
                <div class="tile-icon">ü™ü</div>
                <div class="tile-title">Window List</div>
                <div id="stat-window-count" class="tile-status">0 Windows</div>
            </div>
            <div class="tile tile-purple" onclick="scrollToSection('section-formulas')">
                <div class="tile-icon">üß™</div>
                <div class="tile-title">Formulas</div>
                <div class="tile-status">Series Logic</div>
            </div>
            <div class="tile tile-orange" onclick="scrollToSection('section-stock')">
                <div class="tile-icon">üì¶</div>
                <div class="tile-title">Stock Master</div>
                <div id="stat-stock-count" class="tile-status">Manage Inventory</div>
            </div>
            <div class="tile tile-yellow" onclick="scrollToSection('section-supplier')" style="--tile-color: #f1c40f;">
                <div class="tile-icon">üèõÔ∏è</div>
                <div class="tile-title">Supplier Master</div>
                <div class="tile-status">Catalogue</div>
            </div>
            <div class="tile tile-navy" onclick="scrollToSection('section-hardware')">
                <div class="tile-icon">üî©</div>
                <div class="tile-title">Hardware Master</div>
                <div class="tile-status">Manage Items</div>
            </div>
            <div class="tile tile-red" onclick="scrollToSection('section-optimize')">
                <div class="tile-icon">‚ö°</div>
                <div class="tile-title">Optimize</div>
                <div class="tile-status">Run Analysis</div>
            </div>
            <div class="tile tile-teal" onclick="scrollToSection('section-results')">
                <div class="tile-icon">üìä</div>
                <div class="tile-title">Results</div>
                <div class="tile-status">View Reports</div>
            </div>
        </div>

        <!-- Section 1: Add Windows / Doors -->
        <section id="section-add-windows" class="section collapsed-section">
            <h2 class="collapsible-header collapsed" onclick="toggleSection(this)">
                ‚ûï Add Configuration <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content collapsed-content">
                <!-- Mode Tabs: Window vs Door -->
                <div class="mode-tabs" style="margin-bottom: 20px;">
                    <button type="button" class="mode-tab active" id="modeTabWindow"
                        onclick="switchAddMode('Window')">ü™ü Add Window</button>
                    <button type="button" class="mode-tab" id="modeTabDoor" onclick="switchAddMode('Door')">üö™ Add
                        Door</button>
                </div>

                <!-- WINDOW FORM (3-step wizard) -->
                <div id="windowFormContainer">
                    <form id="windowForm" onsubmit="addWindow(event)">
                        <!-- Step Progress Indicators -->
                        <div class="step-indicators">
                            <div class="step-dot active" data-step="1">1</div>
                            <div class="step-line"></div>
                            <div class="step-dot" data-step="2">2</div>
                            <div class="step-line"></div>
                            <div class="step-dot" data-step="3">3</div>
                        </div>
                        <div class="step-labels">
                            <span>Size & Series</span>
                            <span>Supplier</span>
                            <span>Hardware</span>
                        </div>

                        <!-- STEP 1: Dimensions & Series -->
                        <div class="wizard-step" id="step1">
                            <input type="hidden" id="category" value="Window">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Config ID</label>
                                    <input type="text" id="configId" value="W01" required>
                                </div>
                                <div class="form-group">
                                    <label>Project Name</label>
                                    <input type="text" id="projectName" value="check" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Width <span class="unit-label">(inches)</span></label>
                                    <input type="number" id="width" step="0.25" value="65" required>
                                </div>
                                <div class="form-group">
                                    <label>Height <span class="unit-label">(inches)</span></label>
                                    <input type="number" id="height" step="0.25" value="56" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group" style="flex: 2;">
                                    <label>Series Type</label>
                                    <select id="series" onchange="onSeriesChanged()" required>
                                        <option value="">-- Select Series First --</option>
                                        <!-- Populated dynamically -->
                                    </select>
                                </div>
                            </div>
                            <div class="wizard-actions">
                                <button type="button" class="btn btn-primary" onclick="nextStep(2)">Next: Select
                                    Supplier
                                    ‚û°Ô∏è</button>
                            </div>
                        </div>

                        <!-- STEP 2: Supplier Selection -->
                        <div class="wizard-step hidden" id="step2">
                            <div class="alert alert-info">
                                Showing suppliers available for <strong><span
                                        id="selectedSeriesDisplay">...</span></strong>
                                series.
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Vendor / Supplier</label>
                                    <select id="windowVendor" required onchange="toggleInterlockByVendor()">
                                        <option value="">-- Select Vendor --</option>
                                        <!-- Filtered by Series -->
                                    </select>
                                </div>
                            </div>
                            <div class="wizard-actions">
                                <button type="button" class="btn btn-secondary" onclick="prevStep(1)">‚¨ÖÔ∏è Back</button>
                                <button type="button" class="btn btn-primary" onclick="nextStep(3)">Next: Hardware &
                                    Planning ‚û°Ô∏è</button>
                            </div>
                        </div>

                        <!-- STEP 3: Hardware & Planning -->
                        <div class="wizard-step hidden" id="step3">
                            <div class="form-row" id="windowTracksRow">
                                <div class="form-group">
                                    <label>Tracks</label>
                                    <select id="tracks" required>
                                        <option value="2">2 Tracks</option>
                                        <option value="3" selected>3 Tracks</option>
                                        <option value="4">4 Tracks</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Glass Shutters (S)</label>
                                    <select id="shutters" required>
                                        <option value="1">1 Shutter</option>
                                        <option value="2">2 Shutters</option>
                                        <option value="3" selected>3 Shutters</option>
                                        <option value="4">4 Shutters</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Mosquito Shutters (MS)</label>
                                    <select id="mosquitoShutters" onchange="toggleMosquitoConfig()" required>
                                        <option value="0" selected>0 Mosquito Shutter</option>
                                        <option value="1">1 Mosquito Shutter</option>
                                        <option value="2">2 Mosquito Shutters</option>
                                        <option value="3">3 Mosquito Shutters</option>
                                        <option value="4">4 Mosquito Shutters</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row" id="windowGlassRow">
                                <div class="form-group">
                                    <label>Glass Unit & Type</label>
                                    <select id="glassUnit" onchange="updateGlassThicknessOptions()" required>
                                        <option value="none">No Glass</option>
                                        <option value="SGU" selected>SGU (Single Glass 5-8mm)</option>
                                        <option value="DGU">DGU (Double Glass up to 18mm)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Glass Thickness</label>
                                    <select id="glassThickness" required>
                                        <option value="5">5mm</option>
                                        <option value="6">6mm</option>
                                        <option value="8">8mm</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Corner Joint</label>
                                    <select id="cornerJoint" required>
                                        <option value="90" selected>90¬∞ (Reduce handles)</option>
                                        <option value="45">45¬∞ (No reduction)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row" id="windowInterlockRow">
                                <div class="form-group">
                                    <label>Interlock Design</label>
                                    <select id="interlockType" required>
                                        <option value="slim" selected>Slim Interlock (3-Side Shutter)</option>
                                        <option value="universal">Universal (4-Side Shutter + V-2521)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Description</label>
                                    <input type="text" id="description" value="Living Room Window" required>
                                </div>
                            </div>
                            <!-- Mosquito Configuration Row (Dynamically shown if MS > 0) -->
                            <div class="form-row" id="mosquitoConfigRow"
                                style="display: none; background: #f0f7ff; padding: 10px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #3498db;">
                                <div class="form-group">
                                    <label>Mosquito Shutter Type</label>
                                    <select id="mosquitoType">
                                        <option value="V-2513">V-2513 (Screen - 45¬∞)</option>
                                        <option value="V-2517">V-2517 (Shutter - 90¬∞)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Mosquito Interlock</label>
                                    <select id="mosquitoInterlock">
                                        <option value="V-2516" selected>V-2516 (Slim)</option>
                                        <option value="V-2521">V-2521 (Universal)</option>
                                    </select>
                                </div>
                            </div>
                            <!-- Door Configuration Row (Shown when Door category selected) -->
                            <!-- Door Configuration Row (Shown when Door category selected) -->
                            <div id="doorConfigRow"
                                style="display: none; background: #fff5e6; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #e67e22;">
                                <h4 style="margin-top: 0; color: #e67e22;">üö™ Door Configuration</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Frame (Leg Partition)</label>
                                        <select id="doorFrame" onchange="toggleDoorFrame()">
                                            <option value="1" selected>YES - 3 Side Frame</option>
                                            <option value="0">NO - No Frame</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Glass Type</label>
                                        <select id="doorGlassType">
                                            <option value="SGU" selected>SGU (Single)</option>
                                            <option value="DGU">DGU (Double)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Partition Material</label>
                                        <select id="doorPartitionMaterial" onchange="updateDoorPartitionThickness()">
                                            <option value="Glass" selected>Glass</option>
                                            <option value="Bakelite">Bakelite Sheet</option>
                                            <option value="ACP">ACP Sheet</option>
                                            <option value="Louvers">Louvers</option>
                                            <option value="SSMosquito">SS Mosquito Net</option>
                                            <option value="ParticleBoard">Particle Board</option>
                                            <option value="PartitionSheet">Partition Sheet</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Partition Thickness</label>
                                        <select id="doorPartitionThickness">
                                            <option value="5">5mm</option>
                                            <option value="6" selected>6mm</option>
                                            <option value="8">8mm</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Profile Selection -->
                                <h5
                                    style="margin: 15px 0 10px; color: #d35400; border-bottom: 1px solid #f0c27b; padding-bottom: 5px;">
                                    üìê Profile Selection</h5>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Handle Profile (Verticals)</label>
                                        <select id="doorHandleProfile">
                                            <option value="Door Vertical" selected>Door Vertical (Standard)</option>
                                            <option value="Door Tips Vertical">Door Tips Vertical</option>
                                            <option value="Door Middle Single">Door Middle Single</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Bottom Profile</label>
                                        <select id="doorBottomProfile">
                                            <option value="Door Bottom" selected>Door Bottom (114.5mm Wide)</option>
                                            <option value="Door Top 47.5">Door Top (47.5mm Slim)</option>
                                            <option value="Door Top 85">Door Top (85mm Wide)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Door Middle Width</label>
                                        <select id="doorMiddleWidth">
                                            <option value="47.5" selected>47.5mm (Standard)</option>
                                            <option value="85">85mm (Wide)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Door Top Width</label>
                                        <select id="doorTopWidth">
                                            <option value="47.5" selected>47.5mm (Standard)</option>
                                            <option value="85">85mm (Wide)</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row" id="doorFrameInfo" style="margin-top: 10px;">
                                    <div class="alert alert-warning" style="flex: 1; padding: 10px; margin: 0;">
                                        <strong>Frame Deductions:</strong> Width: 80mm | Height: 40mm<br>
                                        <strong>Joint:</strong> 45¬∞ with corner connector
                                    </div>
                                </div>
                            </div>
                            <div class="wizard-actions">
                                <button type="button" class="btn btn-secondary" onclick="prevStep(2)">‚¨ÖÔ∏è Back</button>
                                <button type="button" class="btn btn-danger" onclick="clearForm()">üîÑ Clear</button>
                                <button type="submit" class="btn btn-success" id="submitBtn">‚úÖ Add Window</button>
                            </div>
                        </div>
                    </form>
                </div><!-- End windowFormContainer -->

                <!-- DOOR FORM (Single Page) -->
                <div id="doorFormContainer" style="display: none;">
                    <form id="doorForm" onsubmit="addDoor(event)">
                        <div
                            style="background: #fff5e6; padding: 20px; border-radius: 10px; border-left: 4px solid #e67e22;">
                            <h3 style="margin-top: 0; color: #e67e22;">üö™ Door Configuration</h3>

                            <!-- Row 1: ID, Project, Size -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Config ID</label>
                                    <input type="text" id="doorConfigId" value="D01" readonly
                                        style="background: #f5f5f5;">
                                </div>
                                <div class="form-group">
                                    <label>Project Name</label>
                                    <input type="text" id="doorProjectName" value="check" required>
                                </div>
                                <div class="form-group">
                                    <label>Width <span class="unit-label">(inches)</span></label>
                                    <input type="number" id="doorWidth" step="0.25" value="36" required>
                                </div>
                                <div class="form-group">
                                    <label>Height <span class="unit-label">(inches)</span></label>
                                    <input type="number" id="doorHeight" step="0.25" value="84" required>
                                </div>
                            </div>

                            <!-- Row 2: Vendor, Frame, Glass, Partition -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Vendor / Supplier</label>
                                    <select id="doorVendor" required>
                                        <option value="JK ALU EXTRUSION" selected>JK ALU EXTRUSION</option>
                                        <option value="Windalco Aluminium">Windalco Aluminium</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Frame (Leg Partition)</label>
                                    <select id="doorFrameSelect">
                                        <option value="1" selected>YES - 3 Side Frame</option>
                                        <option value="0">NO - No Frame</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Glass Type</label>
                                    <select id="doorGlassTypeNew">
                                        <option value="SGU" selected>SGU (Single)</option>
                                        <option value="DGU">DGU (Double)</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Row 3: Partition Material & Thickness -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Partition Material</label>
                                    <select id="doorPartitionMaterialNew" onchange="updateDoorPartitionThicknessNew()">
                                        <option value="Glass" selected>Glass</option>
                                        <option value="Bakelite">Bakelite Sheet</option>
                                        <option value="ACP">ACP Sheet</option>
                                        <option value="Louvers">Louvers</option>
                                        <option value="SSMosquito">SS Mosquito Net</option>
                                        <option value="ParticleBoard">Particle Board</option>
                                        <option value="PartitionSheet">Partition Sheet</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Partition Thickness</label>
                                    <select id="doorPartitionThicknessNew">
                                        <option value="5">5mm</option>
                                        <option value="6" selected>6mm</option>
                                        <option value="8">8mm</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Row 4: Profile Selection -->
                            <h5
                                style="margin: 15px 0 10px; color: #d35400; border-bottom: 1px solid #f0c27b; padding-bottom: 5px;">
                                üìê Profile Selection</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Handle Profile (Verticals)</label>
                                    <select id="doorHandleProfileNew">
                                        <option value="Door Vertical" selected>Door Vertical (Standard)</option>
                                        <option value="Door Tips Vertical">Door Tips Vertical</option>
                                        <option value="Door Middle Single">Door Middle Single</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Bottom Profile</label>
                                    <select id="doorBottomProfileNew">
                                        <option value="Door Bottom" selected>Door Bottom (114.5mm Wide)</option>
                                        <option value="Door Top 47.5">Door Top (47.5mm Slim)</option>
                                        <option value="Door Top 85">Door Top (85mm Wide)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Middle Width</label>
                                    <select id="doorMiddleWidthNew">
                                        <option value="47.5" selected>47.5mm (Standard)</option>
                                        <option value="85">85mm (Wide)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Top Width</label>
                                    <select id="doorTopWidthNew">
                                        <option value="47.5" selected>47.5mm (Standard)</option>
                                        <option value="85">85mm (Wide)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Description</label>
                                    <input type="text" id="doorDescription" value="Main Entrance Door" required>
                                </div>
                            </div>

                            <!-- Actions -->
                            <div class="wizard-actions" style="margin-top: 20px;">
                                <button type="button" class="btn btn-danger" onclick="clearDoorForm()">üîÑ Clear</button>
                                <button type="submit" class="btn btn-success">‚úÖ Add Door</button>
                            </div>
                        </div>
                    </form>
                </div><!-- End doorFormContainer -->

            </div>
        </section>

        <!-- Section 2: Window List -->
        <section id="section-window-list" class="section collapsed-section">
            <h2 class="collapsible-header collapsed" onclick="toggleSection(this)">
                ü™ü Window Configurations <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content collapsed-content">
                <div id="windowList" class="window-list"></div>
            </div>
        </section>

        <!-- Section 3: Formulas -->
        <section id="section-formulas" class="section collapsed-section">
            <h2 class="collapsible-header collapsed" onclick="toggleSection(this)">
                üß™ Series Formulas Configuration <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content collapsed-content">
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è Formula Variables:</strong> W = Width, H = Height, S = Shutters, T = Tracks, MS =
                    Mosquito
                    Shutters
                </div>
                <div id="formulasList"></div>
                <div class="section-header">
                    <h3>‚ûï Add New Series / Component</h3>
                </div>
                <form id="newSeriesForm" onsubmit="addNewSeries(event)">
                    <div class="form-group">
                        <label>Series Name</label>
                        <input type="text" id="newSeriesName" placeholder="e.g., 1.5" required>
                    </div>
                    <div class="form-group">
                        <label>Component Name</label>
                        <input type="text" id="newComponentName" placeholder="e.g., 1.5 Handle" required>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" id="newComponentDesc" placeholder="e.g., Handles" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Quantity Formula</label>
                            <input type="text" id="newQtyFormula" placeholder="e.g., 2 or 2*S" required>
                        </div>
                        <div class="form-group">
                            <label>Length Formula</label>
                            <input type="text" id="newLengthFormula" placeholder="e.g., H-1.5" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">‚ûï Add Component</button>
                </form>
            </div>
        </section>

        <!-- Section 3b: Supplier Master -->
        <section id="section-supplier" class="section collapsed-section">
            <h2 class="collapsible-header collapsed" onclick="toggleSection(this)">
                üèõÔ∏è Supplier & Section Master <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content collapsed-content">
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è Supplier Database:</strong> Manage Section Numbers and Weights per 12ft stick.
                </div>
                <div id="supplierMasterList"></div>

                <div class="section-header">
                    <h3>‚ûï Add New Supplier Section</h3>
                </div>
                <form id="newSupplierForm" onsubmit="addNewSupplierSection(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Supplier Name</label>
                            <input type="text" id="supName" list="supplierList" placeholder="e.g., Windalco" required>
                            <datalist id="supplierList"></datalist>
                        </div>
                        <div class="form-group">
                            <label>Series</label>
                            <select id="supSeries" required>
                                <option value="3/4\"">3/4" </option>
                                <option value="1\"">1" </option>
                                <option value="Domal">Domal</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Profile Type</label>
                            <input type="text" id="supMaterial" placeholder="e.g., 3/4\" Handle" required>
                        </div>
                        <div class="form-group">
                            <label>Section No.</label>
                            <input type="text" id="supSectionNo" placeholder="e.g., 20011" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Thickness (T) mm</label>
                            <input type="number" id="supT" step="0.01" placeholder="e.g., 0.79" required>
                        </div>
                        <div class="form-group">
                            <label>Weight (Kg/12ft)</label>
                            <input type="number" id="supWeight" step="0.001" placeholder="e.g., 1.100" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">‚ûï Add to Catalogue</button>
                </form>
            </div>
        </section>

        <!-- Section 4: Stock Master -->
        <section id="section-stock" class="section collapsed-section">
            <h2 class="collapsible-header collapsed" onclick="toggleSection(this)">
                üì¶ Stock Master Configuration <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content collapsed-content">
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è Configure Stock:</strong> Set lengths and costs for optimization
                </div>
                <div class="form-row">
                    <div class="form-group" style="max-width: 300px;">
                        <label>Kerf - Saw Blade Width <span class="unit-label">(inches)</span></label>
                        <input type="number" id="kerfGlobal" value="0.125" step="0.001" onchange="updateKerf()">
                    </div>
                    <div class="form-group" style="max-width: 300px;">
                        <label>Raw Material Price <span class="unit-label">(‚Çπ/Kg)</span></label>
                        <input type="number" id="aluminumRate" value="280" step="1" onchange="updateAluminumRate()">
                    </div>
                </div>
                <div id="stockMasterList"></div>
                <div class="section-header">
                    <h3>‚ûï Add New Stock Material</h3>
                </div>
                <form id="newStockForm" onsubmit="addNewStock(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Series</label>
                            <select id="newStockSeries" onchange="updateNewStockMaterialOptions()" required></select>
                        </div>
                        <div class="form-group">
                            <label>Material / Profile</label>
                            <input type="text" id="newStockMaterial" placeholder="e.g., Domal Shutter"
                                onchange="updateSupplierSectionOptions()" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Supplier (Optional)</label>
                            <select id="newStockSupplier" onchange="updateSupplierSectionOptions()">
                                <option value="">-- No Supplier --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Supplier Section No.</label>
                            <select id="newStockSectionNo" onchange="applySupplierDataToStock()">
                                <option value="">-- Select Section --</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Stock 1 Length <span class="unit-label">(inches)</span></label>
                            <input type="number" id="newStock1" value="141" step="1" required>
                        </div>
                        <div class="form-group">
                            <label>Stock 1 Cost (‚Çπ)</label>
                            <input type="number" id="newStock1Cost" value="100" step="1">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Stock 2 Length <span class="unit-label">(inches)</span></label>
                            <input type="number" id="newStock2" value="177" step="1" required>
                        </div>
                        <div class="form-group">
                            <label>Stock 2 Cost (‚Çπ)</label>
                            <input type="number" id="newStock2Cost" value="125" step="1">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">‚ûï Add Stock Material</button>
                </form>

            </div> <!-- end stock content -->
        </section>

        <!-- Section 4b: Hardware Master -->
        <section id="section-hardware" class="section collapsed-section">
            <h2 class="collapsible-header collapsed" onclick="toggleSection(this)">
                üî© Hardware Master Configuration <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content collapsed-content">
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è Configure Hardware:</strong> Set items and formulas for automated BOM
                </div>

                <!-- Hardware Glossary Section -->
                <div class="hardware-glossary">
                    <div class="glossary-header">
                        <h3>üìñ Hardware Glossary & Guide</h3>
                    </div>
                    <div class="glossary-grid">
                        <!-- Items Section -->
                        <div class="glossary-section">
                            <h4>üî© Common Hardware Items</h4>
                            <div class="glossary-items">
                                <div class="glossary-item">
                                    <span class="glossary-term">Shutter Lock</span>
                                    <span class="glossary-desc">Locking mechanism for sliding shutters.</span>
                                </div>
                                <div class="glossary-item">
                                    <span class="glossary-term">Wool Pile</span>
                                    <span class="glossary-desc">Weather strip to seal gaps (prevents dust/air).</span>
                                </div>
                                <div class="glossary-item">
                                    <span class="glossary-term">Bearing</span>
                                    <span class="glossary-desc">Rollers that let shutters slide smoothly.</span>
                                </div>
                                <div class="glossary-item">
                                    <span class="glossary-term">Interlock Cap</span>
                                    <span class="glossary-desc">End caps for interlock profiles.</span>
                                </div>
                            </div>
                        </div>

                        <!-- Variables Section -->
                        <div class="glossary-section">
                            <h4>üìê Formula Variables</h4>
                            <div class="glossary-items">
                                <div class="glossary-item glossary-item-variable">
                                    <span class="glossary-term"><code>W</code>, <code>H</code></span>
                                    <span class="glossary-desc">Window Width and Height (in inches).</span>
                                </div>
                                <div class="glossary-item glossary-item-variable">
                                    <span class="glossary-term"><code>S</code>, <code>MS</code></span>
                                    <span class="glossary-desc">Number of Shutters / Mosquito Shutters.</span>
                                </div>
                                <div class="glossary-item glossary-item-variable">
                                    <span class="glossary-term"><code>T</code>, <code>P</code></span>
                                    <span class="glossary-desc">Number of Tracks / Total Perimeter.</span>
                                </div>
                                <div class="glossary-item glossary-item-formula">
                                    <span class="glossary-term"><code>GL("Name")</code></span>
                                    <span class="glossary-desc">Get Total Length of a specific profile.</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="hardwareMasterList"></div>
            </div> <!-- end hardware content -->
        </section>

        <!-- Section 4c: Rate Management -->
        <section id="section-rates" class="section collapsed-section">
            <h2 class="collapsible-header collapsed" onclick="toggleSection(this)">
                üí∞ Rate & Price Management <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content collapsed-content">
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è Price Settings:</strong> Configure glass prices and powder coating rates per R.Ft.
                </div>

                <div class="form-row" style="display: block;">
                    <details class="rate-group"
                        style="margin-bottom: 15px; border: 1px solid #ddd; border-radius: 8px; background: white;">
                        <summary
                            style="padding: 12px 15px; cursor: pointer; font-weight: bold; background: #f8f9fa; border-radius: 8px; list-style: none;">
                            üñºÔ∏è Glass Prices (per Sq.Ft)</summary>
                        <div id="glassRatesList" style="padding: 15px; border-top: 1px solid #eee;">
                            <div class="form-row">
                                <div class="form-group"><label>5mm Toughened (‚Çπ)</label><input type="number"
                                        id="rateGlassToughened" value="85" step="1"></div>
                                <div class="form-group"><label>5mm Non-Toughened (‚Çπ)</label><input type="number"
                                        id="rateGlassNonToughened" value="65" step="1"></div>
                            </div>
                        </div>
                    </details>

                    <details class="rate-group"
                        style="margin-bottom: 20px; border: 1px solid #ddd; border-radius: 8px; background: white;">
                        <summary
                            style="padding: 12px 15px; cursor: pointer; font-weight: bold; background: #f8f9fa; border-radius: 8px; list-style: none;">
                            üß™ Global Constants & Offsets</summary>
                        <div style="padding: 15px; border-top: 1px solid #eee;">
                            <div class="form-row">
                                <div class="form-group"><label>Glass Offset (inches)</label><input type="number"
                                        id="glassOffset" value="1.5" step="0.1"></div>
                                <div class="form-group"><label>Rubber Rate (‚Çπ/ft)</label><input type="number"
                                        id="rateRubber" value="5" step="1"></div>
                            </div>
                        </div>
                    </details>
                </div>

                <h3>‚ú® Powder Coating Rates (‚Çπ / Running Foot)</h3>
                <div id="powderCoatingRatesList">
                    <!-- Dynamic powder coating rates will be rendered here -->
                </div>
                <button class="btn btn-success" onclick="saveAllRates()">üíæ Save All Rates</button>
            </div>
        </section>

        <section id="section-optimize" class="section collapsed-section">
            <h2 class="collapsible-header collapsed" onclick="toggleSection(this)">
                ‚ö° Smart Optimization Engine <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content collapsed-content">
                <div class="optimization-mode">
                    <h4>üí∞ Smart Cost Optimization Enabled</h4>
                    <p style="margin: 0; color: #555;">
                        ‚úÖ Minimizes material waste<br>
                        ‚úÖ Prefers cost-effective stock combinations<br>
                        ‚úÖ Considers total project cost
                    </p>
                </div>
                <div class="project-selector">
                    <h3 style="margin-bottom: 15px;">Select Project & Supplier to Optimize</h3>
                    <div class="form-row" style="align-items: flex-end;">
                        <div class="form-group" style="flex: 2;">
                            <label>Project Name</label>
                            <select id="projectSelector">
                                <option value="">-- Select Project --</option>
                            </select>
                        </div>
                        <div class="form-group" style="flex: 2;">
                            <label>Preferred Supplier</label>
                            <select id="projectSupplierSelector" onchange="saveProjectSupplier()">
                                <option value="">-- Select Supplier --</option>
                            </select>
                        </div>
                    </div>
                    <p style="margin-top: 10px; color: #856404;">
                        <strong>Selected Project Info:</strong> <span id="projectInfo">No project selected</span>
                    </p>
                </div>
                <div style="text-align: center; padding: 40px;">
                    <button class="btn btn-success" onclick="runOptimization()"
                        style="font-size: 20px; padding: 20px 50px;">
                        üöÄ RUN SMART OPTIMIZATION
                    </button>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-primary" onclick="generateQuotation()"
                        style="font-size: 16px; padding: 15px 30px;">
                        üìÑ Generate Quotation
                    </button>
                    <button class="btn btn-info" onclick="generatePurchaseListPDF()"
                        style="font-size: 16px; padding: 15px 30px; margin-left: 10px;">
                        üìã Download Purchase List
                    </button>
                    <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è Clear All Saved Data</button>
                </div>
            </div>
        </section>

        <section id="section-results" class="section collapsed-section">
            <h2 class="collapsible-header collapsed" onclick="toggleSection(this)">
                üìä Optimization Results <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content collapsed-content">
                <div id="resultsContent"></div>
            </div>
        </section>

        <!-- Section 7: Export Preview (Modal-like section) -->
        <section id="section-preview" class="section collapsed-section" style="display: none;">
            <h2 class="collapsible-header" onclick="toggleSection(this)">
                üìÑ Export Preview <span class="toggle-indicator">‚ñº</span>
            </h2>
            <div class="collapsible-content">
                <div class="preview-actions" style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button class="btn btn-danger" onclick="closeExportPreview()">‚ùå Close Preview</button>
                    <button class="btn btn-success" id="downloadExportBtn">üíæ Download PDF</button>
                    <button class="btn btn-info" id="downloadExcelBtn">üìä Download Excel</button>
                </div>
                <div id="reportPreviewContent"
                    style="background: white; padding: 40px; border: 1px solid #ccc; box-shadow: 0 0 20px rgba(0,0,0,0.1); color: black; font-family: 'Helvetica', Arial, sans-serif; min-height: 800px; overflow-x: auto;">
                    <!-- Preview HTML will be injected here -->
                </div>
            </div>
        </section>
    </div>

    <!-- Modals -->
    <div id="addComponentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ûï Add New Component</h3>
                <button class="close-btn" onclick="closeAddComponentModal()">&times;</button>
            </div>
            <form id="addComponentForm" onsubmit="saveNewComponent(event)">
                <input type="hidden" id="addComponentSeries">
                <div class="form-group">
                    <label>Component Name</label>
                    <input type="text" id="modalComponentName" placeholder="e.g., Domal Handle" required>
                </div>
                <div class="form-group">
                    <label>Quantity Formula</label>
                    <input type="text" id="modalComponentQty" placeholder="e.g., 2*S or 4" required>
                    <small style="color: #7f8c8d;">Use variables: W (width), H (height), S (shutters), MS
                        (mosquito)</small>
                </div>
                <div class="form-group">
                    <label>Length Formula</label>
                    <input type="text" id="modalComponentLength" placeholder="e.g., H-2.75 or W/2" required>
                    <small style="color: #7f8c8d;">Use variables: W (width), H (height), S (shutters)</small>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <input type="text" id="modalComponentDesc" placeholder="e.g., Side Handle" required>
                </div>
                <div style="text-align: right; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" onclick="closeAddComponentModal()">Cancel</button>
                    <button type="submit" class="btn btn-success">Add Component</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Hardware Modal -->
    <div id="addHardwareModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ûï Add Hardware Item</h3>
                <button class="close-btn" onclick="closeAddHardwareModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addHardwareForm" onsubmit="saveNewHardwareItem(event)">
                    <input type="hidden" id="addHardwareSeries">
                    <div class="form-group">
                        <label>Hardware Name</label>
                        <input type="text" id="modalHardwareName" placeholder="e.g., Shutter Lock" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Unit</label>
                            <select id="modalHardwareUnit">
                                <option value="Nos">Nos</option>
                                <option value="Meter">Meter</option>
                                <option value="Bottle">Bottle</option>
                                <option value="Set">Set</option>
                                <option value="Kg">Kg</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Base Rate (‚Çπ)</label>
                            <input type="number" id="modalHardwareRate" placeholder="0.00" step="0.01" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Calculation Formula</label>
                        <input type="text" id="modalHardwareFormula" placeholder="e.g., 2 * S + MS" required>
                        <small style="color: #666;">Available: W (Width), H (Height), S (Shutters), MS (Mosquito), T
                            (Tracks), P (Perimeter), GL("Name") (Profile Length)</small>
                    </div>
                    <div style="text-align: right; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary"
                            onclick="closeAddHardwareModal()">Cancel</button>
                        <button type="submit" class="btn btn-success">üíæ Save Hardware Item</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    </div>

    <!-- Section Selection Modal -->
    <div id="sectionSelectModal" class="modal">
        <div class="modal-content" style="max-width: 800px; max-height: 95vh;">
            <div class="modal-header">
                <h3>üèõÔ∏è Select Thickness & Section</h3>
                <button class="close-btn" onclick="closeSectionSelectModal()">&times;</button>
            </div>
            <div id="sectionSelectContent" class="modal-body">
                <div class="alert alert-info" style="margin-bottom: 20px;">
                    Select thickness for <strong><span id="selectMaterialName"></span></strong>
                </div>

                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">Available Thickness
                        Options:</label>
                    <select id="thicknessSelect"
                        style="width: 100%; padding: 10px; font-size: 14px; border: 2px solid #3498db; border-radius: 5px;"
                        onchange="showSelectedSectionDetails()">
                        <option value="">-- Select Thickness --</option>
                    </select>
                </div>

                <div id="selectedSectionDetails"
                    style="background: #e8f5e9; padding: 15px; border-radius: 5px; margin-bottom: 15px; display: none;">
                    <h4 style="margin-top: 0; color: #2e7d32;">Selected Section Details:</h4>
                    <div id="sectionDetailsContent"></div>
                </div>

                <div style="margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="closeSectionSelectModal()">Cancel</button>
                    <button class="btn btn-success" onclick="confirmSectionSelection()" style="float: right;">‚úì Confirm
                        Selection</button>
                </div>

                <details style="margin-top: 25px; border-top: 1px solid #ddd; padding-top: 15px;">
                    <summary
                        style="cursor: pointer; font-weight: bold; color: #3498db; padding: 10px; background: #ecf0f1; border-radius: 5px;">
                        üìã View All Available Sections in Catalogue
                    </summary>
                    <div id="catalogueList"
                        style="max-height: 400px; overflow-y: auto; margin-top: 10px; padding: 10px; background: #fff; border: 1px solid #eee; border-radius: 4px;">
                        <!-- Catalogue sections will be rendered here -->
                    </div>
                </details>
            </div>
        </div>
    </div>

    <!-- Edit Window Modal -->
    <div id="editWindowModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚úèÔ∏è Edit Window</h3>
                <button class="close-btn" onclick="closeEditWindowModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editWindowForm" onsubmit="saveWindowEdit(event)">
                    <input type="hidden" id="editWindowIndex">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Config ID</label>
                            <input type="text" id="editConfigId" required>
                        </div>
                        <div class="form-group">
                            <label>Project Name</label>
                            <input type="text" id="editProjectName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Width <span class="unit-label">(inches)</span></label>
                            <input type="number" id="editWidth" step="0.25" required>
                        </div>
                        <div class="form-group">
                            <label>Height <span class="unit-label">(inches)</span></label>
                            <input type="number" id="editHeight" step="0.25" required>
                        </div>
                    </div>
                    <!-- Window Specific Fields -->
                    <div id="editWindowSpecificFields">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Tracks</label>
                                <select id="editTracks">
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Shutters</label>
                                <select id="editShutters">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Mosquito</label>
                                <select id="editMosquitoShutters" onchange="toggleEditMosquitoConfig()">
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Door Specific Fields -->
                    <div id="editDoorSpecificFields"
                        style="display: none; background: #fff5e6; padding: 10px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid #e67e22;">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Frame (Leg Partition)</label>
                                <select id="editDoorFrame" onchange="toggleEditDoorFrame()">
                                    <option value="1">YES - 3 Side Frame</option>
                                    <option value="0">NO - No Frame</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Handle Profile</label>
                                <select id="editDoorHandleProfile">
                                    <option value="Door Vertical">Door Vertical (Standard)</option>
                                    <option value="Door Tips Vertical">Door Tips Vertical</option>
                                    <option value="Door Middle Single">Door Middle Single</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Bottom Profile</label>
                                <select id="editDoorBottomProfile">
                                    <option value="Door Bottom">Door Bottom</option>
                                    <option value="Door Top">Door Top (Slim)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Middle Width</label>
                                <select id="editDoorMiddleWidth">
                                    <option value="47.5">47.5mm</option>
                                    <option value="85">85mm</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Top Width</label>
                                <select id="editDoorTopWidth">
                                    <option value="47.5">47.5mm</option>
                                    <option value="85">85mm</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Vendor / Supplier</label>
                            <select id="editWindowVendor" onchange="filterEditSeriesByVendor()" required>
                                <option value="">-- Select Vendor --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Series</label>
                            <select id="editSeries" required>
                                <option value="">-- Select Vendor First --</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Glass Unit</label>
                            <select id="editGlassUnit" onchange="updateEditGlassThicknessOptions()">
                                <option value="none">No Glass</option>
                                <option value="SGU">SGU</option>
                                <option value="DGU">DGU</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Glass Thickness</label>
                            <select id="editGlassThickness"></select>
                        </div>
                        <div class="form-group">
                            <label>Corner Joint</label>
                            <select id="editCornerJoint">
                                <option value="90">90¬∞</option>
                                <option value="45">45¬∞</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Interlock Design</label>
                            <select id="editInterlockType">
                                <option value="slim">Slim</option>
                                <option value="universal">Universal</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <input type="text" id="editDescription">
                        </div>
                    </div>
                    <div class="form-row" id="editMosquitoConfigRow" style="display: none;">
                        <div class="form-group">
                            <label>Mosquito Type</label>
                            <select id="editMosquitoType">
                                <option value="V-2513">V-2513</option>
                                <option value="V-2517">V-2517</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Mosquito Interlock</label>
                            <select id="editMosquitoInterlock">
                                <option value="V-2516">V-2516</option>
                                <option value="V-2521">V-2521</option>
                            </select>
                        </div>
                    </div>
                    <div style="margin-top: 20px;">
                        <button type="submit" class="btn btn-success">üíæ Save Changes</button>
                        <button type="button" class="btn btn-danger" onclick="closeEditWindowModal()">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alertModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="alertModalTitle">Notification</h3>
                <button class="close-btn" onclick="closeAlertModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="alertModalIcon" class="modal-icon"></div>
                <p id="alertModalMessage">Message goes here.</p>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-modal-success" onclick="closeAlertModal()">OK</button>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Action</h3>
                <button class="close-btn" onclick="closeConfirmModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="confirmModalIcon" class="modal-icon">‚ö†Ô∏è</div>
                <p id="confirmModalMessage">Are you sure?</p>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-modal-cancel" id="confirmCancelBtn">Cancel</button>
                <button class="btn-modal btn-modal-confirm" id="confirmOkBtn">Confirm</button>
            </div>
        </div>
    </div>

    <div id="editFormulaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚úèÔ∏è Edit Formula</h3>
                <button class="close-btn" onclick="closeEditFormulaModal()">&times;</button>
            </div>
            <form id="editFormulaForm" onsubmit="saveFormulaEdit(event)">
                <input type="hidden" id="editFormulaSeries">
                <input type="hidden" id="editFormulaIndex">
                <div class="form-group">
                    <label>Component Name</label>
                    <input type="text" id="editFormulaComponent" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <input type="text" id="editFormulaDesc" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Quantity Formula</label>
                        <input type="text" id="editFormulaQty" required>
                    </div>
                    <div class="form-group">
                        <label>Length Formula</label>
                        <input type="text" id="editFormulaLength" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-success">üíæ Save Changes</button>
                <button type="button" class="btn btn-danger" onclick="closeEditFormulaModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Section Selection Modal -->
    <div id="sectionSelectModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>üìê Select Thickness / Section</h3>
                <button class="close-btn" onclick="closeSectionSelectModal()">&times;</button>
            </div>
            <div class="modal-body" style="max-height: 400px; overflow-y: auto;">
                <div id="sectionSelectionList">
                    <!-- Options will be populated dynamically -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSectionSelectModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- JavaScript Files - Load in Order -->
    <script src="js/storage.js"></script>
    <script src="js/supplier_master.js"></script>
    <!-- Supplier Modules -->
    <script src="js/suppliers/windalco.js"></script>
    <script src="js/suppliers/jk_alu.js"></script>
    <script src="js/suppliers/atlantis.js"></script>
    <script src="js/suppliers/vitco.js"></script>

    <script src="js/app.js"></script>
    <script src="js/optimization.js"></script>
    <script src="js/exports.js"></script>
    <script src="js/quotation.js"></script>

</body>

</html>